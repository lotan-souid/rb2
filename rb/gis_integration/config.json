{
  "_comments": [
    "pg_featureserv_url: כתובת שרת pg_featureserv (כולל פרוטוקול ופורט)",
    "pg_featureserv_timeout: זמן קצוב (בשניות) לבקשות HTTP מהשרת",
    "collections: מיפוי בין DocTypeים ב-Frappe לבין שכבות/Collections ב-pg_featureserv",
    "site_config.json תחת המפתח 'gis_integration' יכול לעקוף את הערכים כאן לסביבות שונות"
  ],
  "pg_featureserv_url": "http://192.168.0.101:9000",
  "pg_featureserv_timeout": 30,
  "basemaps": {
    "default": {
      "url": "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",
      "options": {
        "maxZoom": 19,
        "attribution": "&copy; OpenStreetMap contributors"
      }
    },
    "A": {
      "url": "https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/%7Bz%7D/%7By%7D/%7Bx%7D",
      "options": {
        "attribution": "Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community"
      }
    },
    "B": {
      "url": "https://tiles.arcgis.com/tiles/utNNrmXb4IZOLXXs/arcgis/rest/services/Orthophoto2022/MapServer/tile/{z}/{y}/{x}",
      "options": {
        "minZoom": 0,
        "maxZoom": 20,
        "attribution": "Orthophoto 2022 © Survey of Israel / Esri",
        "tileSize": 256
      }
    }
  },
  "collections": {
    "Lot": {
      "_comments": [
        "collection: שם ה-collection ב-pg_featureserv ממנו נמשוך ישויות",
        "id_field: שם השדה בדוק-טייפ Lot שמכיל את מזהה הישות לחיפוש",
        "geometry_target_field: שם השדה ב-Lot אליו תישמר הגיאומטריה (GeoJSON)",
        "fetch_mode: 'by_property' (חיפוש לפי תכונה) או 'by_id' (קריאה ל-items/{id})",
        "property_name: שם התכונה בצד ה-GIS (כאשר fetch_mode='by_property')",
        "fallback_properties: רשימת שדות חלופיים מהטופס לנסות במקרה ולא נמצאה התאמה"
      ],
      "collection": "rb_layers.lots",
      "id_field": "lot_id",
      "geometry_target_field": "location",
      "fetch_mode": "by_property",
      "property_name": "lotId",
      "fallback_properties": ["lot_number"],
      "map": {
        "geolocation_field": "location",
        "default_basemap": "default",
        "default_zoom": 12,
        "available_basemaps": ["default", "A", "B"]
      }
    },
    "Plan": {
      "_comments": [
        "Mapping for Plan DocType to GIS layer",
        "collection: pg_featureserv collection (schema.table) containing plans",
        "id_field: DocType field used to match GIS features",
        "geometry_target_field: DocType field to store simplified GeoJSON",
        "property_name: GIS-side attribute to match Plan numbers"
      ],
      "collection": "rb_layers.plans",
      "id_field": "plan_number",
      "geometry_target_field": "location",
      "fetch_mode": "by_property",
      "property_name": "plan",
      "map": {
        "geolocation_field": "location",
        "default_basemap": "default",
        "default_zoom": 11,
        "available_basemaps": ["default", "A", "B"],
        "fit_to_geometry": true
      }
    },
    "Cluster": {
      "_comments": [
        "Mapping for Cluster DocType to GIS layer",
        "collection: pg_featureserv collection (schema.table)",
        "id_field: DocType field used to match GIS features",
        "geometry_target_field: DocType field to store simplified GeoJSON",
        "fetch_mode: use property filter to match by field",
        "property_name: GIS-side attribute to match (e.g., clusterName)"
      ],
      "collection": "rb_layers.clusters",
      "id_field": "cluster_name",
      "geometry_target_field": "location",
      "fetch_mode": "by_property",
      "property_name": "clusterName",
      "map": {
        "geolocation_field": "location",
        "default_basemap": "default",
        "default_zoom": 10,
        "available_basemaps": ["default", "A", "B"],
        "fit_to_geometry": false
      }
    },
    "Fixture Compensation": {
      "_comments": [
        "Mapping for Fixture Compensation DocType to GIS layer",
        "collection: pg_featureserv collection (schema.table) containing fixtures",
        "id_field: DocType field storing the unique FXC-* identifier (defaults to name)",
        "geometry_target_field: destination Geolocation field on the DocType",
        "fetch_mode: when omitted defaults to by_id which calls items/{id}",
        "map: client-side Geolocation widget defaults"
      ],
      "collection": "rb_layers.fixture_compensation",
      "id_field": "name",
      "geometry_target_field": "location",
      "fetch_mode": "by_property",
      "property_name": "fixture_id",
      "map": {
        "geolocation_field": "location",
        "default_basemap": "default",
        "default_zoom": 13,
        "available_basemaps": ["default", "A", "B"],
        "fit_to_geometry": true
      }
    }
  }
}
